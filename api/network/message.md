# message Command

## Description

Insert a timestamped text message or a log event for a given entity and tags into the database.

Special fields supported by the message command:

* `type` - message type, used in search index
* `source` - message source, used in search index
* `severity` - criticality level, can be specified in [numeric or text format](#severity).

`type`, `source`, and `entity` fields are indexed and therefore provide fast response time for search queries.

`severity` field is exposed in the rule engine for filtering and alerting.

## Syntax

```css
message e:{entity} t:type={type} t:source={source} t:severity={severity} t:tag={tag-value} m:{message} s:{seconds}
```

### Fields

| **Field** | **Required** | **Description** |
|:---|:---|:---|
| e         | yes          | Entity name. |
| t         | no           | Tags, including reserved tags: `type`, `source`, [`severity`](/api/data/severity.md). |
| m         | no           | Message text. |
| p         | no           | Persist message in the database. Default: true.<br>If disabled, the message is only processed by the rule-engine.
| s         | no           | Time in UNIX seconds. | 
| ms        | no           | Time in UNIX milliseconds. | 
| d         | no           | Time in ISO format. | 

* If time fields are omitted, the record is inserted with the current server time.
* Message text or at least one tag is required, otherwise the message will be dropped silently.
* Enclose tag values and message text containing space or double-quote in double-quotes.

### ABNF Syntax

Rules inherited from [base ABNF](base-abnf.md).

```properties
  ; message or at least one tag is required
command = "message" MSP entity [MSP tag-type] [MSP tag-source] [MSP tag-severity] *(MSP tag) [MSP time] [MSP persist] [MSP message] 
entity = "e:" NAME
tag-type = "t:type=" VALUE
tag-source = "t:source=" VALUE
  ; severity value is case-insensitive
  ; https://tools.ietf.org/html/rfc7405#section-2.1
tag-severity = "t:severity=" (%x30-37 / %i("UNDEFINED"/"UNKNOWN"/"NORMAL"/"WARNING"/"MINOR"/"MAJOR"/"CRITICAL"/"FATAL") )
tag = "t:" NAME "=" VALUE
message = "m:" VALUE
persist = "p:" ("true" / "false")
time = time-millisecond / time-second / time-iso
time-millisecond = "ms:" POSITIVE_INTEGER
time-second = "s:" POSITIVE_INTEGER
time-iso = "d:" ISO_DATE
```

## Severity

In order for alerts generated by the rule engine to inherit message severity, set severity to 'unknown' on Alerts tab in Rule Engine editor.  

## Examples

```ls
message e:server001 t:type=application t:source=cron t:job="backup" m:"Task completed" d:2016-03-04T12:43:20Z
```

```ls
message e:server001 t:type=collector-job t:job_name=nginx-connect-check t:job_type=TCP t:status=COMPLETED
```

```ls
message e:server001 t:type=logger t:source=parsingstatistics t:level=ERROR s:1464076784
```
