# Aggregate Per Period

Statistics per period.

## Query

```sql
SELECT datetime, avg(value), max(value), last(value), count(*)
 FROM mpstat.cpu_busy
WHERE entity = 'nurswgvml007' 
 AND datetime >= current_day
 GROUP BY PERIOD(1 HOUR)
```

## Results

```ls
| datetime                 | avg(value) | max(value) | last(value) | count(*) | 
|--------------------------|------------|------------|-------------|----------| 
| 2016-07-15T00:00:00.000Z | 11.564     | 100.000    | 27.000      | 225.000  | 
| 2016-07-15T01:00:00.000Z | 15.485     | 100.000    | 27.780      | 225.000  | 
| 2016-07-15T02:00:00.000Z | 17.268     | 100.000    | 36.360      | 224.000  | 
| 2016-07-15T03:00:00.000Z | 15.001     | 100.000    | 6.000       | 224.000  | 
| 2016-07-15T04:00:00.000Z | 12.744     | 100.000    | 15.000      | 225.000  | 
| 2016-07-15T05:00:00.000Z | 9.135      | 97.980     | 7.070       | 225.000  | 
| 2016-07-15T06:00:00.000Z | 10.301     | 100.000    | 92.930      | 225.000  | 
| 2016-07-15T07:00:00.000Z | 10.345     | 100.000    | 6.000       | 225.000  | 
| 2016-07-15T08:00:00.000Z | 11.958     | 100.000    | 38.950      | 225.000  | 
| 2016-07-15T09:00:00.000Z | 11.566     | 100.000    | 6.060       | 224.000  | 
| 2016-07-15T10:00:00.000Z | 16.180     | 100.000    | 99.000      | 222.000  | 
| 2016-07-15T11:00:00.000Z | 11.921     | 100.000    | 7.070       | 225.000  | 
| 2016-07-15T12:00:00.000Z | 10.906     | 100.000    | 8.000       | 225.000  | 
| 2016-07-15T13:00:00.000Z | 12.709     | 100.000    | 45.260      | 224.000  | 
| 2016-07-15T14:00:00.000Z | 14.204     | 100.000    | 7.000       | 213.000  | 
```

## Query

Display period start and end time using `date_format` function.


```sql
SELECT datetime AS period_start, date_format(time+60*60000) AS period_end, avg(value)
  FROM mpstat.cpu_busy
WHERE entity = 'nurswgvml007' 
  AND datetime >= current_day
GROUP BY PERIOD(1 HOUR)
```

## Results

```ls
| period_start             | period_end               | avg(value) | 
|--------------------------|--------------------------|------------| 
| 2016-08-25T00:00:00.000Z | 2016-08-25T01:00:00.000Z | 7.7        | 
| 2016-08-25T01:00:00.000Z | 2016-08-25T02:00:00.000Z | 8.2        | 
| 2016-08-25T02:00:00.000Z | 2016-08-25T03:00:00.000Z | 6.7        | 
```
